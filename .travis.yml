language: python

dist: xenial

addons:
  sonarcloud:
    organization: "madworx"

python: 2.7

virtualenv:
   system_site_packages: true

sudo: required

before_install:
   - sudo add-apt-repository -y ppa:js-reynaud/kicad-5
   - sudo apt-get update
   - sudo apt install --assume-yes kicad kicad-symbols kicad-footprints
   - make setup

script:
   - make tests
   - sonar-scanner
   - make dist
   - make doc

deploy:
   provider: releases
   api_key:
      secure: e7LRwziBqApiSkXYmlMQinSZfds/ksRkbq9zsAkXPue7LY2Ew+SdmreQbiC/axducyoPMYSr7IrmvH+1QQW0ciBmmzWb1kIPi0F60+noEbwoRrn3UuF3LLSN57X67kP5fh9cnz54+DsSax+8t6ccqg/tIM5Bk9baMTXxNLh3TzxbED1O/foWSJ0SzSINSMr+4YfT/IjVQPU/1LODSwlQYbuJxgWy0Du8GvJzC5KElR0LCUkLuAS74GXm+8vcebI4cp+cOs/QLub1jPyZNSsJK41lZpUUU1VnZe9LIvML0DsBVmJg23z5gFAsf5D3fhmRKoVbCQhuidaM/Fogk57tOj+gBuucCO3GiPeE3phZfBOVDqNhr2immfho5Ves0sVNvt+yPo2gLX1S5svLP3LpsNHtTMmJ23EeyA0wHzt3YXYxkbVsLxY9OWc9HUCwVPZvB3Wr3e5OiVRHWPnKTRKteA/wdJHjYE61GJb1ppZZJDY42s1p3J1Xgm9c5v5zJ3dJe543BZ81pcbqUrAxmuMGmQdYeFVRiLmyaaMrySAewLb6PJ45ja+BNrJMOKFYdH3jiavcevglD46bN4XPWhnFkOyB28hwwMuwM0C9tfhHPLGpXhJiJIKV6diGJzPdSIlp55tKfU8IN+Ez2dRkfq8H+2FwJ1NRvlnRFW4Np3el25M=
   file_glob: true
   file:
      - docs/KiCadLibrary.html
      - dist/robotframework*
   skip_cleanup: true
   overwrite: true
   on:
      repo: madworx/robotframework-kicadlibrary
      tags: true
      all_branches: true
